# airnbnb

Objetivo: Criar um modelo de classificação binária para prever o room_type

Estratégia/Função de custo:
  - Primeiro foi feito uma clusterização com as variaveis númericas com intuito de descobrir padrões que ajudassem na abordagem superviosionada, portanto foi criado uma clusterização com base no k-means para dar como input no modelo de classificação a posteriori.A função de custo do kmeans é a somatória das distancias ao quadrado dos pontos ao centroide de seu respectivo cluster, porem para definição de melhor K foi utilizado o silhouette score que leva em consideração a distância intra-cluster ou coesão (função de custo mencionada) e além disso considera a distância entre clusters com intuito de medir separabilidade. Por fim foi escolhida a maior  silhouette.
  - Após definido o cluster foi utilizado o variance threshould nas variaveis continuas para tirar variaveis constantes ou que possuam uma pequena variação essa estratégia tem o intuito de não deixar que pequenas variações impactem no modelo, além disso foi retirado a correlação entre as variaveis continuas, retirado os outliers e foi feito a normalização dos dados com intuito de utilizados dentro do cluster, pois o Kmeans, algoritmo escolhido, é sensivel a outliers e dados com escala diferente, pois é baseado no cálculo de distância euclidiana.
  - Após isso, foi treinado uma random forest para cada room_type e para encontrar o melhor modelo foi feito uma otimização dos hiperparametros, utilizando random search, foram otimizados alguns parametros para evitar overfitting e diminuir  a complexidade do modelo como max_depth, min_samples_split, min_samples_leaf a utilização do random forest foi devido a ser um algoritmo rápido por ser paralelizável e fácil de controlar o trade-off vies e variancia comparado com outros modelos como gradient boosting, regressao logistica e etc.
  - Avaliação e validação foi feita observando o KS que basicamente irá ver qual o poder de discriminação do meu modelo comparando a distancia das funções de probabilidade da minha classe positiva e negativa, aqui o objetivo é ter a maior distancia possivel entre essas duas distribuições (classe positiva e negativa) que trará um modelo com ótimo poder de discriminação, além disso foram olhadas outras métricas como ROC AUC, precision, recall, kappa.
  - Por se tratar de um problema multiclasse foi escolhido a estratégia one versus rest com o objetivo de criar um modelo para cada room_type disponível 
